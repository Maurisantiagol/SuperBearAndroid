"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.throttle = throttle;

var _effector = require("effector");

function throttle({
  source,
  timeout,
  target = (0, _effector.createEvent)({
    name: "target",
    sid: "cenyj5"
  })
}) {
  if (!_effector.is.unit(source)) throw new TypeError('source must be unit from effector');
  if (typeof timeout !== 'number' || timeout < 0) throw new Error('timeout must be positive number or zero');
  const timerFx = (0, _effector.createEffect)(() => new Promise(resolve => setTimeout(resolve, timeout)), {
    name: "timerFx",
    sid: "uv7gwq"
  });
  (0, _effector.guard)({
    and: [{
      source,
      filter: timerFx.pending.map(pending => !pending),
      target: timerFx
    }],
    or: {
      sid: "-iy4kn2"
    }
  });
  (0, _effector.sample)({
    and: [{
      source,
      clock: timerFx.done,
      target
    }],
    or: {
      sid: "-ija4mb"
    }
  });
  return target;
}
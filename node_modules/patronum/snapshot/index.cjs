"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.snapshot = snapshot;

var _effector = require("effector");

function snapshot({
  source,
  clock,
  fn = value => value
}) {
  const defaultValue = fn(source.defaultState);
  const onSnapshot = clock ? (0, _effector.sample)({
    and: [source, clock, fn],
    or: {
      name: "onSnapshot",
      sid: "-auitd0"
    }
  }) : (0, _effector.sample)({
    and: [{
      source,
      fn
    }],
    or: {
      name: "onSnapshot",
      sid: "-auir6n"
    }
  });
  const $snapshot = (0, _effector.createStore)(defaultValue, {
    name: "$snapshot",
    sid: "-7zyoaf"
  });
  $snapshot.on(onSnapshot, (_, value) => value);
  return $snapshot;
}
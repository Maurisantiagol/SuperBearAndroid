"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.spread = spread;

var _effector = require("effector");

/**
 * @example
 * spread({ source: dataObject, targets: { first: targetA, second: targetB } })
 * forward({
 *   to: spread({targets: { first: targetA, second: targetB } })
 * })
 */
function spread({
  targets,
  source = (0, _effector.createEvent)({
    name: "source",
    sid: "-iel8gi"
  })
}) {
  for (const targetKey in targets) {
    if (targetKey in targets) {
      const hasTargetKey = (0, _effector.guard)({
        and: [{
          source,
          filter: object => typeof object === 'object' && object !== null && targetKey in object
        }],
        or: {
          name: "hasTargetKey",
          sid: "-gh83lo"
        }
      });

      if (_effector.is.store(targets[targetKey], {
        sid: "jliekw"
      })) {
        targets[targetKey].on(hasTargetKey, (prev, object) => object[targetKey]);
      } else {
        (0, _effector.sample)({
          and: [{
            source: hasTargetKey,
            fn: object => object[targetKey],
            target: targets[targetKey]
          }],
          or: {
            sid: "lnzpe6"
          }
        });
      }
    }
  }

  return source;
}